{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
   
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h4 class="fw-bold">Repair Request Details</h4>
        <a href="{% url 'technician_dashboard' %}" class="btn btn-secondary">Back to Dashboard</a>
    </div>

   
    <div class="row align-items-center">
       
        <div class="col-md-6">
            <div class="card shadow-sm border-0">
                {% if repair_request.image %}
                    <img src="{{ repair_request.image.url }}" alt="Repair Image" class="card-img-top img-fluid rounded">
                {% else %}
                    <div class="d-flex align-items-center justify-content-center bg-light" style="height: 300px;">
                        <p class="text-muted">No image available</p>
                    </div>
                {% endif %}
            </div>
        </div>

       
        <div class="col-md-6">
            <div class="card shadow-sm border-0 p-4">
                <h4 class="text-primary mb-3">Request Details</h4>
                <p><strong>Request by:</strong> {{ repair_request.employee.user.username }}</p>
                <p><strong>Description:
                    <br>
                </strong> {{ repair_request.description }}</p>
                <p><strong>Current Status:</strong> 
                    <span class="badge 
                    {% if repair_request.status == 'COMPLETED' %}
                    bg-success
                    {% elif repair_request.status == 'IN_PROGRESS' %}bg-warning text-dark
                    {% elif repair_request.status == 'REJECTED' %}
                    bg-danger
                    {% else %}
                    bg-secondary
                    {% endif %}">
                        {{ repair_request.get_status_display }}
                    </span>
                </p>

               
                <form method="POST" class="mt-4">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="status" class="form-label"><strong>New Status</strong></label>
                        <select name="status" id="status" class="form-select" required>
                            <option value="PENDING" {% if repair_request.status == 'PENDING' %}selected{% endif %}>Pending</option>
                            <option value="IN_PROGRESS" {% if repair_request.status == 'IN_PROGRESS' %}selected{% endif %}>In Progress</option>
                            <option value="COMPLETED" {% if repair_request.status == 'COMPLETED' %}selected{% endif %}>Completed</option>
                            <option value="REJECTED" {% if repair_request.status == 'REJECTED' %}selected{% endif %}>Rejected</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-success w-100">Update Status</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
